参考:
- [文章](https://juejin.cn/post/6844903958624878606)
- [rfc](https://www.ietf.org/rfc/rfc793.txt)

TCP 三次握手过程：
1、第一次握手：client 发起连接，发送 SYN=1，seq（x=客户端随机生成的初始化序列号）
2、第二次握手：server 确认收到，发送 SYN=1，ACK=1，ack=x+1，seq（y=服务端生成的初始化序列号）
3、第三次握手：client 确认收到，发送 ACK=1，ack=y+1，seq=x+1
（SYN=1是不可以携带数据的，会消耗掉一个序列号）


TCP 四次挥手过程：
1、第一次挥手：客户端发起断开：FIN=1，seq=序列号


- ISN（initical sequence number）：初始序列号，每当建立新连接的时候，初始序列号生成器随机生成一个32位的编码，每个包都依次编号（+包长度），可以防止一些非法的number、用于重传和接受
- TCP 的可靠连接是靠 seq，ISN 就保证了重传的可靠性
- 为什么挥手需要四次：1、tcp是全双工通信，这是前提；2、所以在客服端第1次挥手时，服务端可能还在发送数据。所以第2次挥手和第3次挥手不能合并

TCP的可靠连接
- 确认和重传：超时没有收到确认消息就重传。确认消息是可以扫着数据传输的包一通携带的，在确认之前可能有段时间延迟，积攒确认消息，以提升tcp传输速率
- 流量控制：服务无法处理当前数据传输速率，窗口调小